var Event={add:function(element,type,handler){if(element.addEventListener){element.addEventListener(type,handler,false);}else if(element.attachEvent){element.attachEvent('on'+type,handler);}else{element['on'+type]=handler;}},remove:function(element,type,handler){if(element.removeEventListener){element.removeEventListener(type,handler,false);}else if(element.detachEvent){element.detachEvent('on'+type,handler);}else{element['on'+type]=null;}},stopPropagation:function(event){if(event.stopPropagation){event.stopPropagation();}else{event.cancelBubble=true;}},preventDefault:function(event){if(event.preventDefault){event.preventDefault();}else{event.returnValue=false;}},getTarget:function(event){return event.target||event.srcElement;},getEvent:function(event){return event?event:window.event;}};;var Ajax={createXMLHttp:function(){var versions=[function(){return new XMLHttpRequest();},function(){return new ActiveXObject("Microsoft.XMLHttp");},function(){return new ActiveXObject("MSXML2.XMLHttp.5.0");},function(){return new ActiveXObject("MSXML2.XMLHttp.4.0");},function(){return new ActiveXObject("MSXML2.XMLHttp.3.0");},function(){return new ActiveXObject("MSXML2.XMLHttp");}];for(var i=0;i<versions.length;i++){try{var request=versions[i]();if(request!=null){return request;}}
catch(exception){continue;}}
throw new Error('您的浏览器不支持XMLHttpRequest');},send:function(url,options){var _options={method:'GET',asyn:true,data:null,onsuccess:function(){},onerror:function(){}};for(var key in options){_options[key]=options[key];}
var request=Ajax.createXMLHttp();request.onreadystatechange=function(){if(request.readyState==4){if(request.status==200){_options.onsuccess(Ajax.getResponse(request));}else{_options.onerror(Ajax.getResponse(request));}}}
request.open(_options.method,url,_options.asyn);if(_options.method=='POST'){request.setRequestHeader('Content-Type','application/x-www-form-urlencoded');}
request.send(_options.data);},getResponse:function(request){switch(request.getResponseHeader('Content-Type')){case'text/xml':return request.responseXML;case'text/json':return JSON.parse(request.responseText);case'text/javascript':case'application/javascript':case'application/x-javascript':return eval(request.responseText);default:return request.responseText;}}}